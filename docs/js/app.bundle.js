"use strict";var app=angular.module("myApp",["ngRoute","ngSanitize","geolocation","myApp.calc","myApp.about","myApp.version"]);app.config(["$locationProvider","$routeProvider",function(e,t){e.hashPrefix("!"),t.otherwise({redirectTo:"/calc"})}]),app.factory("browserLocationService",["geolocation",function(e){return{getLocation:function(){return e.getLocation().then(function(e){return console.log(e),{lat:e.coords.latitude,lng:e.coords.longitude,elevation:e.coords.altitude}})}}}]),app.factory("ipLocationService",["$http",function(e){return{getLocation:function(){return e.get("https://extreme-ip-lookup.com/json/").then(function(e){return{lat:e.data.lat,lng:e.data.lon,zip:e.data.zip,location_name:e.data.city+", "+e.data.region}})}}}]),app.factory("weatherService",["$http",function(e){return{getWeather:function(t,r){const n="https://api.openweathermap.org/data/2.5/weather?lat="+t+"&lon="+r+"&APPID=133cb745ed32ad0dbf2284df34a28987";return e.get(n).then(function(e){return{air_temperature:e.data.main.temp,barometric_pressure:e.data.main.pressure,relative_humidity:e.data.main.humidity}})}}}]),app.factory("elevationService",["$http",function(e){return{getElevation:function(t,r){const n="https://api.open-elevation.com/api/v1/lookup?locations="+t+","+r;return e.get(n).then(function(e){return e.data.results[0].elevation})}}}]),app.factory("calculationService",[function(){function e(e,t){if(t>0){if(e.toString().length-e.toString().lastIndexOf(".")>t+1){var r=Math.pow(10,t);return Math.round(e*r)/r}return e}return Math.round(e)}return{calculate:function(t){var r,n,a,o;r=1*t.elevation,n=1*t.barometric_pressure,o=1.8*(a=1*t.air_temperature-273.15)+32;let i=1*t.relative_humidity;var l,c;let u=(c=.99999683+(l=a)*(l*(78736169e-12+l*(l*(4.3884187e-9+l*(l*(2.1874425e-13+l*(l*(1.1112018e-17+-3.0994571e-20*l)-1.7892321e-15))-2.9883885e-11))-6.1117958e-7))-.0090826951),6.1078/Math.pow(c,8))*i/100;var s,p,d,g,v,h,m=function(e){var t=6369e3;return t*e/(t+e)}(r),f=(s=n,p=m,Math.pow(Math.pow(s,.190263)-8417286e-11*p,1/.190263)),y=function(e,t,r){var n=r+273.15;return 100*t/(461.4964*n)+100*(e-t)/(287.0531*n)}(f,u,a),w=y/1.225*100,b=function(e){var t=6369e3;return t*e/(t-e)}((d=8.31432,g=28.9644,v=1e3*y,h=.23496924566952423*Math.log(288.15*d*v/(101325*g)),-288.15/6.5*(Math.exp(h)-1)*1e3)),_=f*(1/33.86389),A=b*(1/.3048);if(!(A>36090||A<-15e3)){var S=100*e(145442.16*(1-Math.pow(17.326*_/(o+459.67),.235))/100),L={};return L.densaltz=e(A,0),L.densaltzm=e(b,0),L.actpress=e(_,3),L.actpressmb=e(f,2),L.density_m=e(y,3),L.density_e=e(.062428*y,4),L.awosm=e(.3048*S,0),{relative_density:e(w,2),density_altitude:S}}var M='<div class="alert alert-danger">\n  <strong>Error</strong> '+("Out of range for Troposhere Algorithm: Altitude ="+e(A,0)+" feet\nPlease check your input values.")+"\n</div>";$("#messages").append(M)}}}]),angular.module("myApp.calc",["ngRoute"]).config(["$routeProvider",function(e){e.when("/calc",{templateUrl:"views/calc.html",controller:"CalcCtrl"})}]).controller("CalcCtrl",["$scope","browserLocationService","ipLocationService","elevationService","weatherService","calculationService",function(e,t,r,n,a,o){e.elevation=0,e.weather={air_temperature:0,barometric_pressure:0,relative_humidity:0,location_name:"&nbsp;"},e.dac={density_altitude:"n/a",relative_density:"n/a"},t.getLocation().then(function(e){return console.log(e),e}),r.getLocation().then(function(t){return $("#progress-bar").html("Loading location..."),e.location=t,$("#progress-bar").css({width:"25%"}),t}).then(function(){$("#progress-bar").html("Loading elevation..."),n.getElevation(e.location.lat,e.location.lng).then(function(t){return e.elevation=t,$("#progress-bar").css({width:"50%"}),t})}).then(function(){e.location&&($("#progress-bar").html("Loading weather..."),a.getWeather(e.location.lat,e.location.lng).then(function(t){return e.weather=t,$("#progress-bar").css({width:"75%"}),t}))}).then(function(){$("#progress-bar").html("Calculating..."),$("#progress-bar").css({width:"75%"}),e.dac=o.calculate({elevation:e.elevation,barometric_pressure:e.weather.barometric_pressure,air_temperature:e.weather.air_temperature,relative_humidity:e.weather.relative_humidity}),$("#progress-bar").css({width:"100%"}),$("#loading, #loading-overlay").hide()}).catch(function(e){var t='<div class="alert alert-danger">\n  <strong>Error '+e.status+"</strong> "+e.statusText+"\n</div>";$("#messages").append(t)}).finally(function(){$("#progress-bar").css({width:"100%"}),$("#loading, #loading-overlay").hide()})}]),angular.module("myApp.about",["ngRoute"]).config(["$routeProvider",function(e){e.when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"})}]).controller("AboutCtrl",[function(){}]),angular.module("myApp.version",["myApp.version.interpolate-filter","myApp.version.version-directive"]).value("version","0.1"),angular.module("myApp.version.version-directive",[]).directive("appVersion",["version",function(e){return function(t,r,n){r.text(e)}}]),angular.module("myApp.version.interpolate-filter",[]).filter("interpolate",["version",function(e){return function(t){return String(t).replace(/\%VERSION\%/gm,e)}}]);