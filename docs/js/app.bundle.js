"use strict";let app=angular.module("myApp",["ngRoute","ngSanitize","geolocation","myApp.calc","myApp.about","myApp.version"]);app.config(["$locationProvider","$routeProvider",function(e,t){e.hashPrefix("!"),t.otherwise({redirectTo:"/calc"})}]),app.factory("browserLocationService",["geolocation","$q","ipLocationService","elevationService",function(e,t,n,r){return{getLocation:function(){return e.getLocation().then(function(e){return{lat:e.coords.latitude,lng:e.coords.longitude,elevation:e.coords.altitude}},function(e){let o={},a=n.getLocation().then(function(e){o.lat=e.lat,o.lng=e.lng});return t.all([a]).then(function(){return r.getElevation(o.lat,o.lng)}).then(function(e){return o.elevation=e,o})})}}}]),app.factory("ipLocationService",["$http",function(e){return{getLocation:function(){return e.get("https://extreme-ip-lookup.com/json/").then(function(e){return{lat:e.data.lat,lng:e.data.lon,zip:e.data.zip,location_name:e.data.city+", "+e.data.region}})}}}]),app.factory("weatherService",["$http",function(e){return{getWeather:function(t,n){const r="https://api.openweathermap.org/data/2.5/weather?lat="+t+"&lon="+n+"&APPID=133cb745ed32ad0dbf2284df34a28987";return e.get(r).then(function(e){return{air_temperature:e.data.main.temp,barometric_pressure:e.data.main.pressure,relative_humidity:e.data.main.humidity,location_name:e.data.name}})}}}]),app.factory("elevationService",["$http",function(e){return{getElevation:function(t,n){const r="https://api.open-elevation.com/api/v1/lookup?locations="+t+","+n;return e.get(r).then(function(e){return e.data.results[0].elevation})}}}]),app.factory("calculationService",["unitService",function(e){return{calculate:function(e){let t,n,r,o,a;t=1*e.elevation,n=1*e.barometric_pressure,a=1.8*(o=(r=1*e.air_temperature)-273.15)+32;let i=1*e.relative_humidity,l=function(e){let t,n=.99999683+e*(e*(78736169e-12+e*(e*(4.3884187e-9+e*(e*(2.1874425e-13+e*(e*(1.1112018e-17+-3.0994571e-20*e)-1.7892321e-15))-2.9883885e-11))-6.1117958e-7))-.0090826951);return t=6.1078/Math.pow(n,8)}(o)*i/100,u=function(e){let t=6369e3;return t*e/(t+e)}(t),c=(p=n,s=u,Math.pow(Math.pow(p,.190263)-8417286e-11*s,1/.190263));var p,s;let h=function(e,t,n){let r=n+273.15;return 100*t/(461.4964*r)+100*(e-t)/(287.0531*r)}(c,l,o),v=h/1.225*100,f=c*(1/33.86389),d=function(e){let t=6369e3;return t*e/(t-e)}(function(e){let t=8.31432,n=28.9644,r=1e3*e,o=.23496924566952423*Math.log(288.15*t*r/(101325*n));return-288.15/6.5*(Math.exp(o)-1)*1e3}(h))*(1/.3048);if(d>36090||d<-15e3){let e='<div class="alert alert-danger">\n  <strong>Error</strong> '+("Out of range for Troposhere Algorithm: Altitude ="+d+" feet\nPlease check your input values.")+"\n</div>";return void $("#messages").append(e)}let m=(g=o,29.235/(c*(1/33.86389)-l*(1/33.86389))*Math.pow((g+273)/298,.5)*1.18-.18);var g;return{relative_density:v,density_altitude:.3048*(145442.16*(1-Math.pow(17.326*f/(a+459.67),.235))/100*100),horsepower:100/m,dynocf:m}}}}]),app.factory("unitService",[function(){return{kelvinToCelsius:function(e){return e<0?"below absolute zero (0 K)":e-273.15},kelvinToFahrenheit:function(e){return e<0?"below absolute zero (0 K)":9*e/5-459.67},metersToFeet:function(e){return e<0?"input cannot be less than zero":e/.3048},feetToMeters:function(e){return e<0?"input cannot be less than zero":.3048*e},hpaToInchesHg:function(e){return e/33.86389}}}]),angular.module("myApp.calc",["ngRoute"]).config(["$routeProvider",function(e){e.when("/calc",{templateUrl:"views/calc.html",controller:"CalcCtrl"})}]).controller("CalcCtrl",["$scope","$q","browserLocationService","weatherService","calculationService","unitService",function(e,t,n,r,o,a){e.weather={air_temperature:0,barometric_pressure:0,relative_humidity:0,location_name:"&nbsp;"},e.dac={density_altitude:"n/a",relative_density:"n/a"},e.location={lat:0,lng:0,elevation:0},e.units="metric";let i=n.getLocation().then(function(t){e.location=t,e.location.elevationFeet=a.metersToFeet(t.elevation)}),l=t.all([i]).then(function(){return r.getWeather(e.location.lat,e.location.lng).then(function(t){e.weather=t,e.weather.airTemperatureCelsius=a.kelvinToCelsius(t.air_temperature),e.weather.airTemperatureFahrenheit=a.kelvinToFahrenheit(t.air_temperature),e.weather.barometricPressureInHg=a.hpaToInchesHg(t.barometric_pressure)})});t.all([i,l]).then(function(){let t={elevation:e.location.elevation,barometric_pressure:e.weather.barometric_pressure,air_temperature:e.weather.air_temperature,relative_humidity:e.weather.relative_humidity};e.dac=o.calculate(t)}).catch(function(e){let t='<div class="alert alert-danger">\n  <strong>Error:</strong> '+e.message+"\n</div>";$("#messages").append(t)}).finally(function(){$("#loading, #loading-overlay").hide()})}]),angular.module("myApp.about",["ngRoute"]).config(["$routeProvider",function(e){e.when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"})}]).controller("AboutCtrl",[function(){}]),angular.module("myApp.version",["myApp.version.interpolate-filter","myApp.version.version-directive"]).value("version","0.1"),angular.module("myApp.version.version-directive",[]).directive("appVersion",["version",function(e){return function(t,n,r){n.text(e)}}]),angular.module("myApp.version.interpolate-filter",[]).filter("interpolate",["version",function(e){return function(t){return String(t).replace(/\%VERSION\%/gm,e)}}]);